{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\henriquet\\\\Desktop\\\\projetos\\\\SIM_WEB\\\\src\\\\pages\\\\LeituraConsumo\\\\index.js\";\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport Shimmer from 'react-shimmer-effect';\nimport { toast } from 'react-toastify';\nimport { format } from 'date-fns';\nimport { confirmAlert } from 'react-confirm-alert';\nimport 'react-confirm-alert/src/react-confirm-alert.css';\nimport { TwoColumns, EmptyContainer, TableWrapper } from './styles';\nimport { useModal } from '../../hook/useModal';\nimport Select from '../../components/Select';\nimport Icon from '../../components/Icons';\nimport LoadLine from '../../components/LoadLine';\nimport Container from '../../components/Container';\nimport ButtonAdd from '../../components/ButtonAdd';\nimport ConfirmAlert from '../../components/ConfirmAlert';\nimport UhsPaxFormModal from './components/UhsPaxFormModal';\nimport TableDropDownCustom from '../../components/TableDropDownCustom';\nimport ConsumptionReadingFormModal from './components/ConsumptionReadingFormModal';\nimport api from '../../services/api';\nimport { changeDateAction } from '../../store/modules/consumo/consumptionreading/actions';\nconst clocksConfigs = [{\n  name: 'Gás',\n  value: 'GAS'\n}, {\n  name: 'Energia',\n  value: 'ELECTRICITY'\n}, {\n  name: 'Água',\n  value: 'WATER'\n}];\nexport default function LeituraConsumo() {\n  const dispatch = useDispatch();\n  const [loading, setLoading] = useState(false);\n  const [clockListId, setClockListId] = useState([]);\n  const [clockId, setClockId] = useState();\n  const [clocksConsumption, setClocksConsumption] = useState([]);\n  const [occupation, setOccupation] = useState([]);\n  const [payload, setPayload] = useState({});\n  const [currentClock, setCurrentClock] = useState({});\n  const clockIdRef = useRef();\n  const {\n    RenderModal: UhsPaxModalWrapper,\n    ...uhsPaxHook\n  } = useModal();\n  const {\n    RenderModal: ConsumptionReadingModalWrapper,\n    ...consumptionreadingHook\n  } = useModal();\n  const hotelID = useSelector(state => state.user.profile.activeHotel);\n  const consumptionreading = useSelector(state => state.consumptionreading);\n  const clockConfig = clocksConfigs.find(a => a.value === consumptionreading.consumption[0]);\n\n  function getActiveHotelFromLocalStorage() {\n    const data = JSON.parse(localStorage.getItem('persist:sim'));\n    const user = data.user ? JSON.parse(data.user) : {};\n    const activeHotel = user.profile ? user.profile.activeHotel : 0;\n    return Number(activeHotel);\n  }\n\n  const loadClockID = useCallback(async () => {\n    try {\n      const response = await api.get(`/clocks`, {\n        params: {\n          hotel_id: getActiveHotelFromLocalStorage(),\n          clock_type: consumptionreading.consumption[0]\n        }\n      });\n      setClockListId(response.data);\n    } catch (error) {} // toast.error('Não foi possível carregar relógios.');\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [consumptionreading, getActiveHotelFromLocalStorage()]);\n  const loadClocksConsumption = useCallback(async () => {\n    try {\n      setLoading(true);\n      if (consumptionreading.date === null) return;\n      if (!clockId) return;\n      const setYear = consumptionreading.date.getFullYear();\n      const setMonth = consumptionreading.date.getMonth() + 1;\n      const response = await api.get(`/hotels/${hotelID}/clocks/${clockId}/consumptions`, {\n        params: {\n          month: setMonth,\n          year: setYear\n        }\n      });\n      const mapped = response.data.map(item => ({ ...item,\n        read_at: format(new Date(item.read_at), 'dd/MM/yyyy')\n      }));\n      setClocksConsumption(mapped);\n    } catch (error) {// toast.error('Não foi possível carregar lista de consumo.');\n    }\n\n    setLoading(false);\n  }, [clockId, consumptionreading.date, hotelID]);\n  const loadOccupation = useCallback(async () => {\n    try {\n      setLoading(true);\n      const setYear = consumptionreading.date.getFullYear();\n      const setMonth = consumptionreading.date.getMonth() + 1;\n      const response = await api.get(`/hotels/${hotelID}/occupations`, {\n        params: {\n          month: setMonth,\n          year: setYear\n        }\n      });\n      setOccupation(response.data);\n    } catch (error) {// toast.error('Não foi possível carregar ocupação.');\n    }\n\n    setLoading(false);\n  }, [consumptionreading.date, hotelID]);\n  useEffect(() => {\n    dispatch(changeDateAction(new Date()));\n  }, []); // eslint-disable-line\n\n  useEffect(() => {\n    document.title = 'SIM - Consumo | Leitura de Consumo';\n    loadClockID();\n  }, [loadClockID]);\n  useEffect(() => {\n    loadClocksConsumption();\n  }, [loadClocksConsumption]);\n  useEffect(() => {\n    loadOccupation();\n  }, [loadOccupation]);\n\n  const handleOpenModal = async (modalFn, item) => {\n    setPayload(item);\n    modalFn();\n  };\n\n  async function handleOccupationDelete(myObj) {\n    if (!Array.isArray(myObj.key)) {\n      throw new Error('Key is not an array');\n    }\n\n    const values = myObj.key;\n    const newValues = {};\n    values.forEach(value => {\n      newValues[value] = 0;\n    });\n\n    async function deleteIdividualEntries() {\n      try {\n        await api.delete(`hotels/${hotelID}/occupations/${myObj.id}`, {});\n        toast.success('Ocupação excluída com sucesso.');\n        loadOccupation();\n      } catch (error) {\n        toast.error('Não foi possível remover a ocupação selecionado.');\n      }\n    }\n\n    confirmAlert({\n      customUI: ({\n        onClose\n      } // eslint-disable-line\n      ) => React.createElement(ConfirmAlert, {\n        callback: deleteIdividualEntries,\n        onClose: onClose,\n        icon: React.createElement(Icon, {\n          name: \"iconTrash\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 196\n          },\n          __self: this\n        }),\n        title: \"Deletar ocupa\\xE7\\xE3o\",\n        message: React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 199\n          },\n          __self: this\n        }, \"Tem certeza que deseja deletar a ocupa\\xE7\\xE3o de \", React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 200\n          },\n          __self: this\n        }), React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 201\n          },\n          __self: this\n        }, myObj.day), \"/\", React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 201\n          },\n          __self: this\n        }, myObj.month), \"/\", React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 202\n          },\n          __self: this\n        }, myObj.year), \"?\"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      })\n    });\n  }\n\n  async function handleConsumptionReadingDelete(id) {\n    async function deleteIdividualEntries() {\n      try {\n        await api.delete(`hotels/${hotelID}/consumptions/${id}`, {});\n        toast.success('Leitura de consumo excluída com sucesso.');\n        loadClocksConsumption();\n      } catch (error) {\n        toast.error('Não foi possível remover leitura de consumo selecionada.');\n      }\n    }\n\n    confirmAlert({\n      customUI: ({\n        onClose\n      } // eslint-disable-line\n      ) => React.createElement(ConfirmAlert, {\n        callback: deleteIdividualEntries,\n        onClose: onClose,\n        icon: React.createElement(Icon, {\n          name: \"iconTrash\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 230\n          },\n          __self: this\n        }),\n        title: \"Deletar leitura de consumo\",\n        message: React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 232\n          },\n          __self: this\n        }, \"Tem certeza que deseja deletar leitura de consumo?\"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      })\n    });\n  }\n\n  function handleClockOnChange() {\n    var _clockIdRef$current$s2;\n\n    const currentClockValue = clockListId.find(value => {\n      var _clockIdRef$current$s;\n\n      // eslint-disable-next-line radix\n      return value.id === parseInt((_clockIdRef$current$s = clockIdRef.current.selectedOptions[0]) === null || _clockIdRef$current$s === void 0 ? void 0 : _clockIdRef$current$s.id);\n    });\n    setCurrentClock(currentClockValue);\n    setClockId((_clockIdRef$current$s2 = clockIdRef.current.selectedOptions[0]) === null || _clockIdRef$current$s2 === void 0 ? void 0 : _clockIdRef$current$s2.id);\n  }\n\n  useEffect(() => {\n    handleClockOnChange(); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [handleClockOnChange]);\n  return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n    id: \"modal-root\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253\n    },\n    __self: this\n  }), React.createElement(UhsPaxModalWrapper, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254\n    },\n    __self: this\n  }, React.createElement(UhsPaxFormModal, {\n    handleClose: uhsPaxHook.hide,\n    item: payload,\n    loadOccupation: loadOccupation,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255\n    },\n    __self: this\n  })), React.createElement(ConsumptionReadingModalWrapper, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262\n    },\n    __self: this\n  }, React.createElement(ConsumptionReadingFormModal, {\n    handleClose: consumptionreadingHook.hide,\n    item: payload,\n    loadClocksConsumption: loadClocksConsumption,\n    clockListId: clockListId,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263\n    },\n    __self: this\n  })), React.createElement(TwoColumns, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271\n    },\n    __self: this\n  }, React.createElement(Container, {\n    className: \"content full\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"title title--equal\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 273\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 274\n    },\n    __self: this\n  }, \"Ocupa\\xE7\\xE3o\")), React.createElement(TableWrapper, {\n    className: \"flex\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 277\n    },\n    __self: this\n  }, React.createElement(\"table\", {\n    className: \"day\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278\n    },\n    __self: this\n  }, React.createElement(\"thead\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 279\n    },\n    __self: this\n  }, React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 280\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281\n    },\n    __self: this\n  }, \"Dia\"))), React.createElement(\"tbody\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284\n    },\n    __self: this\n  }, loading ? React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286\n    },\n    __self: this\n  }, React.createElement(\"td\", {\n    width: \"15%\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287\n    },\n    __self: this\n  }, React.createElement(Shimmer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288\n    },\n    __self: this\n  }, React.createElement(LoadLine, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289\n    },\n    __self: this\n  })))) : occupation.map(item => React.createElement(\"tr\", {\n    key: item.day,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295\n    },\n    __self: this\n  }, React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296\n    },\n    __self: this\n  }, item.day))))), React.createElement(\"table\", {\n    className: \"table_right\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303\n    },\n    __self: this\n  }, React.createElement(\"thead\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 304\n    },\n    __self: this\n  }, React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 305\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306\n    },\n    __self: this\n  }, \"PAX\"), React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 307\n    },\n    __self: this\n  }, \"UHs\"), React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308\n    },\n    __self: this\n  }, \"\\xA0\"))), React.createElement(\"tbody\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 311\n    },\n    __self: this\n  }, loading ? React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313\n    },\n    __self: this\n  }, React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 319\n    },\n    __self: this\n  }, React.createElement(Shimmer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 320\n    },\n    __self: this\n  }, React.createElement(LoadLine, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 321\n    },\n    __self: this\n  }))), React.createElement(\"td\", {\n    colSpan: \"2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324\n    },\n    __self: this\n  }, React.createElement(Shimmer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 325\n    },\n    __self: this\n  }, React.createElement(LoadLine, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 326\n    },\n    __self: this\n  })))) : occupation.map(item => React.createElement(\"tr\", {\n    key: item.day,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 332\n    },\n    __self: this\n  }, !item.pax && !item.uhs ? React.createElement(\"td\", {\n    colSpan: \"3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 335\n    },\n    __self: this\n  }, React.createElement(ButtonAdd, {\n    onClick: () => handleOpenModal(uhsPaxHook.show, item),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336\n    },\n    __self: this\n  }, React.createElement(Icon, {\n    name: \"iconPlus\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 341\n    },\n    __self: this\n  }), \"Adicionar\")) : React.createElement(React.Fragment, null, React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 347\n    },\n    __self: this\n  }, item.pax), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 348\n    },\n    __self: this\n  }, item.uhs), React.createElement(\"td\", {\n    width: \"75\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 349\n    },\n    __self: this\n  }, React.createElement(TableDropDownCustom, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 350\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    type: \"button\",\n    onClick: () => {\n      handleOccupationDelete({\n        key: ['pax', 'uhs'],\n        ...item\n      });\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 351\n    },\n    __self: this\n  }, \"Excluir\")))))))))), React.createElement(Container, {\n    className: \"content full\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 373\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: `title title--dropdown dd-${consumptionreading.consumption}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"dd-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 377\n    },\n    __self: this\n  }, \"Consumo de \", React.createElement(\"strong\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 378\n    },\n    __self: this\n  }, clockConfig && clockConfig.name), React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 379\n    },\n    __self: this\n  }, consumptionreading.date && consumptionreading.date.getMonth() + 1, ' ', \"/\", consumptionreading.date && consumptionreading.date.getFullYear())), React.createElement(\"div\", {\n    className: \"dd-select\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 388\n    },\n    __self: this\n  }, React.createElement(Icon, {\n    name: \"iconClockSmall\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 389\n    },\n    __self: this\n  }), React.createElement(Select, {\n    name: \"clockid\",\n    onChange: () => {\n      handleClockOnChange();\n    },\n    options: clockListId,\n    defaultOption: currentClock,\n    value: currentClock,\n    ref: clockIdRef,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 390\n    },\n    __self: this\n  }))), !currentClock ? React.createElement(EmptyContainer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 406\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"inner\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 407\n    },\n    __self: this\n  }, React.createElement(Icon, {\n    name: \"iconClockBig\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 408\n    },\n    __self: this\n  }), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 409\n    },\n    __self: this\n  }, \"Nenhum rel\\xF3gio foi encontrado.\"))) : React.createElement(TableWrapper, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 413\n    },\n    __self: this\n  }, React.createElement(\"table\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 414\n    },\n    __self: this\n  }, React.createElement(\"thead\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 415\n    },\n    __self: this\n  }, React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 416\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 417\n    },\n    __self: this\n  }, \"Leitura\"), React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 418\n    },\n    __self: this\n  }, \"Consumo\"), React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 419\n    },\n    __self: this\n  }, \"Hora\"), React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 420\n    },\n    __self: this\n  }, currentClock && currentClock.read_unit_of_measurement ? `${currentClock.read_unit_of_measurement.toLowerCase()}/UHs` : 'UHs'), React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 425\n    },\n    __self: this\n  }, \"\\xA0\"))), React.createElement(\"tbody\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 428\n    },\n    __self: this\n  }, loading ? React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 430\n    },\n    __self: this\n  }, React.createElement(\"td\", {\n    width: \"15%\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 431\n    },\n    __self: this\n  }, React.createElement(Shimmer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 432\n    },\n    __self: this\n  }, React.createElement(LoadLine, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 433\n    },\n    __self: this\n  }))), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 436\n    },\n    __self: this\n  }, React.createElement(Shimmer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 437\n    },\n    __self: this\n  }, React.createElement(LoadLine, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 438\n    },\n    __self: this\n  }))), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 441\n    },\n    __self: this\n  }, React.createElement(Shimmer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 442\n    },\n    __self: this\n  }, React.createElement(LoadLine, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 443\n    },\n    __self: this\n  }))), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 446\n    },\n    __self: this\n  }, React.createElement(Shimmer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 447\n    },\n    __self: this\n  }, React.createElement(LoadLine, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 448\n    },\n    __self: this\n  })))) : clocksConsumption.map(item => React.createElement(\"tr\", {\n    key: item.day,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 454\n    },\n    __self: this\n  }, !item.read ? React.createElement(\"td\", {\n    colSpan: \"5\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 456\n    },\n    __self: this\n  }, React.createElement(ButtonAdd, {\n    onClick: () => handleOpenModal(consumptionreadingHook.show, item),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 457\n    },\n    __self: this\n  }, React.createElement(Icon, {\n    name: \"iconPlus\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 465\n    },\n    __self: this\n  }), \"Adicionar\")) : React.createElement(React.Fragment, null, React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 471\n    },\n    __self: this\n  }, item.read, item.read_unit_of_measurement), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 475\n    },\n    __self: this\n  }, item.consumption_value ? item.consumption_value : '0', item.read_unit_of_measurement), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 481\n    },\n    __self: this\n  }, item.hour), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 482\n    },\n    __self: this\n  }, item.consumption_uhs ? item.consumption_uhs : '', item.read_unit_of_measurement), React.createElement(\"td\", {\n    width: \"75\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 486\n    },\n    __self: this\n  }, React.createElement(TableDropDownCustom, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 487\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    type: \"button\",\n    onClick: () => {\n      handleConsumptionReadingDelete(item.id);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 488\n    },\n    __self: this\n  }, \"Excluir\"))))))))))));\n}","map":{"version":3,"sources":["C:/Users/henriquet/Desktop/projetos/SIM_WEB/src/pages/LeituraConsumo/index.js"],"names":["React","useState","useEffect","useCallback","useRef","useSelector","useDispatch","Shimmer","toast","format","confirmAlert","TwoColumns","EmptyContainer","TableWrapper","useModal","Select","Icon","LoadLine","Container","ButtonAdd","ConfirmAlert","UhsPaxFormModal","TableDropDownCustom","ConsumptionReadingFormModal","api","changeDateAction","clocksConfigs","name","value","LeituraConsumo","dispatch","loading","setLoading","clockListId","setClockListId","clockId","setClockId","clocksConsumption","setClocksConsumption","occupation","setOccupation","payload","setPayload","currentClock","setCurrentClock","clockIdRef","RenderModal","UhsPaxModalWrapper","uhsPaxHook","ConsumptionReadingModalWrapper","consumptionreadingHook","hotelID","state","user","profile","activeHotel","consumptionreading","clockConfig","find","a","consumption","getActiveHotelFromLocalStorage","data","JSON","parse","localStorage","getItem","Number","loadClockID","response","get","params","hotel_id","clock_type","error","loadClocksConsumption","date","setYear","getFullYear","setMonth","getMonth","month","year","mapped","map","item","read_at","Date","loadOccupation","document","title","handleOpenModal","modalFn","handleOccupationDelete","myObj","Array","isArray","key","Error","values","newValues","forEach","deleteIdividualEntries","delete","id","success","customUI","onClose","day","handleConsumptionReadingDelete","handleClockOnChange","currentClockValue","parseInt","current","selectedOptions","hide","pax","uhs","show","read_unit_of_measurement","toLowerCase","read","consumption_value","hour","consumption_uhs"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport Shimmer from 'react-shimmer-effect';\nimport { toast } from 'react-toastify';\nimport { format } from 'date-fns';\nimport { confirmAlert } from 'react-confirm-alert';\nimport 'react-confirm-alert/src/react-confirm-alert.css';\n\nimport { TwoColumns, EmptyContainer, TableWrapper } from './styles';\n\nimport { useModal } from '../../hook/useModal';\n\nimport Select from '../../components/Select';\nimport Icon from '../../components/Icons';\nimport LoadLine from '../../components/LoadLine';\nimport Container from '../../components/Container';\nimport ButtonAdd from '../../components/ButtonAdd';\nimport ConfirmAlert from '../../components/ConfirmAlert';\nimport UhsPaxFormModal from './components/UhsPaxFormModal';\nimport TableDropDownCustom from '../../components/TableDropDownCustom';\nimport ConsumptionReadingFormModal from './components/ConsumptionReadingFormModal';\n\nimport api from '../../services/api';\n\nimport { changeDateAction } from '../../store/modules/consumo/consumptionreading/actions';\n\nconst clocksConfigs = [\n  {\n    name: 'Gás',\n    value: 'GAS',\n  },\n  {\n    name: 'Energia',\n    value: 'ELECTRICITY',\n  },\n  {\n    name: 'Água',\n    value: 'WATER',\n  },\n];\n\nexport default function LeituraConsumo() {\n  const dispatch = useDispatch();\n  const [loading, setLoading] = useState(false);\n  const [clockListId, setClockListId] = useState([]);\n  const [clockId, setClockId] = useState();\n  const [clocksConsumption, setClocksConsumption] = useState([]);\n  const [occupation, setOccupation] = useState([]);\n  const [payload, setPayload] = useState({});\n  const [currentClock, setCurrentClock] = useState({});\n  const clockIdRef = useRef();\n  const { RenderModal: UhsPaxModalWrapper, ...uhsPaxHook } = useModal();\n  const {\n    RenderModal: ConsumptionReadingModalWrapper,\n    ...consumptionreadingHook\n  } = useModal();\n\n  const hotelID = useSelector(state => state.user.profile.activeHotel);\n  const consumptionreading = useSelector(state => state.consumptionreading);\n\n  const clockConfig = clocksConfigs.find(\n    a => a.value === consumptionreading.consumption[0]\n  );\n\n  function getActiveHotelFromLocalStorage() {\n    const data = JSON.parse(localStorage.getItem('persist:sim'));\n    const user = data.user ? JSON.parse(data.user) : {};\n    const activeHotel = user.profile ? user.profile.activeHotel : 0;\n\n    return Number(activeHotel);\n  }\n\n  const loadClockID = useCallback(async () => {\n    try {\n      const response = await api.get(`/clocks`, {\n        params: {\n          hotel_id: getActiveHotelFromLocalStorage(),\n          clock_type: consumptionreading.consumption[0],\n        },\n      });\n      setClockListId(response.data);\n    } catch (error) {\n      // toast.error('Não foi possível carregar relógios.');\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [consumptionreading, getActiveHotelFromLocalStorage()]);\n\n  const loadClocksConsumption = useCallback(async () => {\n    try {\n      setLoading(true);\n\n      if (consumptionreading.date === null) return;\n\n      if (!clockId) return;\n\n      const setYear = consumptionreading.date.getFullYear();\n      const setMonth = consumptionreading.date.getMonth() + 1;\n\n      const response = await api.get(\n        `/hotels/${hotelID}/clocks/${clockId}/consumptions`,\n        {\n          params: {\n            month: setMonth,\n            year: setYear,\n          },\n        }\n      );\n\n      const mapped = response.data.map(item => ({\n        ...item,\n        read_at: format(new Date(item.read_at), 'dd/MM/yyyy'),\n      }));\n\n      setClocksConsumption(mapped);\n    } catch (error) {\n      // toast.error('Não foi possível carregar lista de consumo.');\n    }\n    setLoading(false);\n  }, [clockId, consumptionreading.date, hotelID]);\n\n  const loadOccupation = useCallback(async () => {\n    try {\n      setLoading(true);\n\n      const setYear = consumptionreading.date.getFullYear();\n      const setMonth = consumptionreading.date.getMonth() + 1;\n\n      const response = await api.get(`/hotels/${hotelID}/occupations`, {\n        params: {\n          month: setMonth,\n          year: setYear,\n        },\n      });\n\n      setOccupation(response.data);\n    } catch (error) {\n      // toast.error('Não foi possível carregar ocupação.');\n    }\n    setLoading(false);\n  }, [consumptionreading.date, hotelID]);\n\n  useEffect(() => {\n    dispatch(changeDateAction(new Date()));\n  }, []); // eslint-disable-line\n\n  useEffect(() => {\n    document.title = 'SIM - Consumo | Leitura de Consumo';\n\n    loadClockID();\n  }, [loadClockID]);\n\n  useEffect(() => {\n    loadClocksConsumption();\n  }, [loadClocksConsumption]);\n\n  useEffect(() => {\n    loadOccupation();\n  }, [loadOccupation]);\n\n  const handleOpenModal = async (modalFn, item) => {\n    setPayload(item);\n    modalFn();\n  };\n\n  async function handleOccupationDelete(myObj) {\n    if (!Array.isArray(myObj.key)) {\n      throw new Error('Key is not an array');\n    }\n\n    const values = myObj.key;\n    const newValues = {};\n    values.forEach(value => {\n      newValues[value] = 0;\n    });\n\n    async function deleteIdividualEntries() {\n      try {\n        await api.delete(`hotels/${hotelID}/occupations/${myObj.id}`, {});\n\n        toast.success('Ocupação excluída com sucesso.');\n\n        loadOccupation();\n      } catch (error) {\n        toast.error('Não foi possível remover a ocupação selecionado.');\n      }\n    }\n\n    confirmAlert({\n      customUI: (\n        { onClose } // eslint-disable-line\n      ) => (\n        <ConfirmAlert\n          callback={deleteIdividualEntries}\n          onClose={onClose}\n          icon={<Icon name=\"iconTrash\" />}\n          title=\"Deletar ocupação\"\n          message={\n            <p>\n              Tem certeza que deseja deletar a ocupação de <br />\n              <strong>{myObj.day}</strong>/<strong>{myObj.month}</strong>/\n              <strong>{myObj.year}</strong>?\n            </p>\n          }\n        />\n      ),\n    });\n  }\n\n  async function handleConsumptionReadingDelete(id) {\n    async function deleteIdividualEntries() {\n      try {\n        await api.delete(`hotels/${hotelID}/consumptions/${id}`, {});\n\n        toast.success('Leitura de consumo excluída com sucesso.');\n\n        loadClocksConsumption();\n      } catch (error) {\n        toast.error('Não foi possível remover leitura de consumo selecionada.');\n      }\n    }\n\n    confirmAlert({\n      customUI: (\n        { onClose } // eslint-disable-line\n      ) => (\n        <ConfirmAlert\n          callback={deleteIdividualEntries}\n          onClose={onClose}\n          icon={<Icon name=\"iconTrash\" />}\n          title=\"Deletar leitura de consumo\"\n          message={<p>Tem certeza que deseja deletar leitura de consumo?</p>}\n        />\n      ),\n    });\n  }\n\n  function handleClockOnChange() {\n    const currentClockValue = clockListId.find(value => {\n      // eslint-disable-next-line radix\n      return value.id === parseInt(clockIdRef.current.selectedOptions[0]?.id);\n    });\n    setCurrentClock(currentClockValue);\n    setClockId(clockIdRef.current.selectedOptions[0]?.id);\n  }\n  useEffect(() => {\n    handleClockOnChange();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [handleClockOnChange]);\n\n  return (\n    <>\n      <div id=\"modal-root\" />\n      <UhsPaxModalWrapper>\n        <UhsPaxFormModal\n          handleClose={uhsPaxHook.hide}\n          item={payload}\n          loadOccupation={loadOccupation}\n        />\n      </UhsPaxModalWrapper>\n\n      <ConsumptionReadingModalWrapper>\n        <ConsumptionReadingFormModal\n          handleClose={consumptionreadingHook.hide}\n          item={payload}\n          loadClocksConsumption={loadClocksConsumption}\n          clockListId={clockListId}\n        />\n      </ConsumptionReadingModalWrapper>\n\n      <TwoColumns>\n        <Container className=\"content full\">\n          <div className=\"title title--equal\">\n            <h1>Ocupação</h1>\n          </div>\n\n          <TableWrapper className=\"flex\">\n            <table className=\"day\">\n              <thead>\n                <tr>\n                  <th>Dia</th>\n                </tr>\n              </thead>\n              <tbody>\n                {loading ? (\n                  <tr>\n                    <td width=\"15%\">\n                      <Shimmer>\n                        <LoadLine />\n                      </Shimmer>\n                    </td>\n                  </tr>\n                ) : (\n                  occupation.map(item => (\n                    <tr key={item.day}>\n                      <td>{item.day}</td>\n                    </tr>\n                  ))\n                )}\n              </tbody>\n            </table>\n\n            <table className=\"table_right\">\n              <thead>\n                <tr>\n                  <th>PAX</th>\n                  <th>UHs</th>\n                  <th>&nbsp;</th>\n                </tr>\n              </thead>\n              <tbody>\n                {loading ? (\n                  <tr>\n                    {/* <td width=\"15%\">\n                      <Shimmer>\n                        <LoadLine />\n                      </Shimmer>\n                    </td> */}\n                    <td>\n                      <Shimmer>\n                        <LoadLine />\n                      </Shimmer>\n                    </td>\n                    <td colSpan=\"2\">\n                      <Shimmer>\n                        <LoadLine />\n                      </Shimmer>\n                    </td>\n                  </tr>\n                ) : (\n                  occupation.map(item => (\n                    <tr key={item.day}>\n                      {/* // <td>{item.day}</td> */}\n                      {!item.pax && !item.uhs ? (\n                        <td colSpan=\"3\">\n                          <ButtonAdd\n                            onClick={() =>\n                              handleOpenModal(uhsPaxHook.show, item)\n                            }\n                          >\n                            <Icon name=\"iconPlus\" />\n                            Adicionar\n                          </ButtonAdd>\n                        </td>\n                      ) : (\n                        <>\n                          <td>{item.pax}</td>\n                          <td>{item.uhs}</td>\n                          <td width=\"75\">\n                            <TableDropDownCustom>\n                              <button\n                                type=\"button\"\n                                onClick={() => {\n                                  handleOccupationDelete({\n                                    key: ['pax', 'uhs'],\n                                    ...item,\n                                  });\n                                }}\n                              >\n                                Excluir\n                              </button>\n                            </TableDropDownCustom>\n                          </td>\n                        </>\n                      )}\n                    </tr>\n                  ))\n                )}\n              </tbody>\n            </table>\n          </TableWrapper>\n        </Container>\n        <Container className=\"content full\">\n          <div\n            className={`title title--dropdown dd-${consumptionreading.consumption}`}\n          >\n            <div className=\"dd-title\">\n              Consumo de <strong>{clockConfig && clockConfig.name}</strong>\n              <span>\n                {consumptionreading.date &&\n                  consumptionreading.date.getMonth() + 1}{' '}\n                /\n                {consumptionreading.date &&\n                  consumptionreading.date.getFullYear()}\n              </span>\n            </div>\n\n            <div className=\"dd-select\">\n              <Icon name=\"iconClockSmall\" />\n              <Select\n                name=\"clockid\"\n                onChange={() => {\n                  handleClockOnChange();\n                }}\n\n                options={clockListId}\n\n                defaultOption={currentClock}\n                value={currentClock}\n                ref={clockIdRef}\n              />\n            </div>\n          </div>\n\n          {!currentClock ? (\n            <EmptyContainer>\n              <div className=\"inner\">\n                <Icon name=\"iconClockBig\" />\n                <p>Nenhum relógio foi encontrado.</p>\n              </div>\n            </EmptyContainer>\n          ) : (\n            <TableWrapper>\n              <table>\n                <thead>\n                  <tr>\n                    <th>Leitura</th>\n                    <th>Consumo</th>\n                    <th>Hora</th>\n                    <th>\n                      {currentClock && currentClock.read_unit_of_measurement\n                        ? `${currentClock.read_unit_of_measurement.toLowerCase()}/UHs`\n                        : 'UHs'}\n                    </th>\n                    <th>&nbsp;</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {loading ? (\n                    <tr>\n                      <td width=\"15%\">\n                        <Shimmer>\n                          <LoadLine />\n                        </Shimmer>\n                      </td>\n                      <td>\n                        <Shimmer>\n                          <LoadLine />\n                        </Shimmer>\n                      </td>\n                      <td>\n                        <Shimmer>\n                          <LoadLine />\n                        </Shimmer>\n                      </td>\n                      <td>\n                        <Shimmer>\n                          <LoadLine />\n                        </Shimmer>\n                      </td>\n                    </tr>\n                  ) : (\n                    clocksConsumption.map(item => (\n                      <tr key={item.day}>\n                        {!item.read ? (\n                          <td colSpan=\"5\">\n                            <ButtonAdd\n                              onClick={() =>\n                                handleOpenModal(\n                                  consumptionreadingHook.show,\n                                  item\n                                )\n                              }\n                            >\n                              <Icon name=\"iconPlus\" />\n                              Adicionar\n                            </ButtonAdd>\n                          </td>\n                        ) : (\n                          <>\n                            <td>\n                              {item.read}\n                              {item.read_unit_of_measurement}\n                            </td>\n                            <td>\n                              {item.consumption_value\n                                ? item.consumption_value\n                                : '0'}\n                              {item.read_unit_of_measurement}\n                            </td>\n                            <td>{item.hour}</td>\n                            <td>\n                              {item.consumption_uhs ? item.consumption_uhs : ''}\n                              {item.read_unit_of_measurement}\n                            </td>\n                            <td width=\"75\">\n                              <TableDropDownCustom>\n                                <button\n                                  type=\"button\"\n                                  onClick={() => {\n                                    handleConsumptionReadingDelete(item.id);\n                                  }}\n                                >\n                                  Excluir\n                                </button>\n                              </TableDropDownCustom>\n                            </td>\n                          </>\n                        )}\n                      </tr>\n                    ))\n                  )}\n                </tbody>\n              </table>\n            </TableWrapper>\n          )}\n        </Container>\n      </TwoColumns>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}